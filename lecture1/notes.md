---
title: "Reinforcement Learning and Optimal Control"
author: [Pierre-Luc Bacon]
date: "2017-02-20"
subject: "Reinforcement learning, optimal control"
keywords: [reinforcement learning, optimal control]
subtitle: "IFT6760C, Fall 2021"
lang: "en"
header-includes: |
    \usepackage{mathtools}
    \usepackage{awesomebox}
pandoc-latex-environment:
  noteblock: [note]
  tipblock: [tip]
  warningblock: [warning]
  cautionblock: [caution]
  importantblock: [important]
...

# Overview

- Fixed point of a mapping
    - Nonexpansive
    - Hölder-continuous
        - Lipschitz-continuous
    - Contractive
    - Contraction mapping theorem
        - Cauchy sequence
    - Linear maps
        - Matrix of a linear map
    - Neumann lemma (intro)


# Fixed point of an operator

Most if not all algorithms studied in this course are of the form:
\begin{align*}
x^{(k+1)} = Tx^{(k)} \enspace .
\end{align*}
where $T: D \subset \mathbb{R}^n \to \mathbb{R}^n$ is a given mapping (operator).

::: note 
We write $T: D \subset \mathbb{R}^n \to \mathbb{R}^m$ to denote a mapping $T$ with domain $D$ in $\mathbb{R}^n$ and range (image) in $\mathbb{R}^m$.
:::

If there is a $x^\star$ such that $x^\star = T x^\star$, we call call this point $x^\star$ a **fixed point** \underline{of} $T$ (there can be multiple fixed points). Fixed points are also solutions to 
the nonlinear equation of the form $x - Tx = 0$. 

# Hölder-continuous mapping

Definition (Hölder-continuous).

: A mapping $T: D \subset \mathbb{R}^n \to \mathbb{R}^n$ is said to be Hölder-continuous on $D_0 \subset D$ if there exists a $\gamma \geq 0$ and $p \in (0,1]$ such that:
\begin{align*}
\|Tx - Ty \| \leq \gamma \|x - y\|^p,\enspace \forall x,y \in D_0 \enspace .
\end{align*}
If the above holds for $p = 1$, then $T$ is said to be **Lipschitz-continuous** on $D_0$. 



# Nonexpansive mapping

Definition (Nonexpansive).

:    A mapping $T: D \subset \mathbb{R}^n \to \mathbb{R}^n$ is said to be **nonexpansive** on $D_0 \subset D$ if 
    \begin{align*}
    \| Tx - Ty\| \leq \|x - y\|, \forall x,y \in D_0 \enspace .
    \end{align*}
    Furthermore, we say that a mapping is **strictly** nonexpansive on $D_0$ if: 
    \begin{align*}
    \| Tx - Ty \| < \|x - y \|, \forall x, y \in D_0, x \not = y \enspace .
    \end{align*}

#  At most one fixed point


Strictly nonexpansive mappings can have \underline{at most one fixed point}.

To see this, let's pretend that $x^\star, y^\star \in D_0$ are two distinct fixed points of a strictly nonexpansive mapping $T: D \subset \mathbb{R}^n \to \mathbb{R}^n$.

By definition of strictly nonexpansive:
\begin{align*}
\|Tx^\star - Ty^\star\| < \|x^\star - y^\star\| \enspace .
\end{align*}

By definition of fixed point: 
\begin{align*}
\| x^\star - y^\star \| = \| Tx^\star - Ty^\star\| \enspace .
\end{align*}

Leading to the contradiction: 
\begin{align*}
\| x^\star - y^\star \| = \| Tx^\star - Ty^\star\| < \|x^\star - y^\star\| \enspace .
\end{align*}

# Existence in strictly nonexpansive mappings 

Establishing that a mapping is strictly nonexpansive is \underline{not sufficient to conclude that there exists} a fixed point. 

An example of this (to show) is the one-dimensional strictly nonexpansive mapping $T$ defined as:
\begin{align*}
Tx \triangleq \begin{cases}x + \exp(-x/2) & x \geq 0 \\ \exp(x/2) & x \leq 0\end{cases} \enspace .
\end{align*}

# Contractive mapping

Definition (Contractive).

: A mapping $T: D \subset \mathbb{R}^n \to \mathbb{R}^n$ is **contractive** on $D_0 \subset D$ if there exists a $\gamma < 1$ such that:
\begin{align*}
\|Tx - Ty \| \leq \gamma \|x - y \|, \enspace \forall x,y \in D_0
\end{align*}

We call a mapping with this property a **contractive mapping**.

::: warning

Contraction is a norm-dependent concept. We may establish that a mapping is contractive under a given norm of $\mathbb{R}^n$, but later find that it doesn't hold under a different norm.

:::

# Connection with other notion 

Given the above definitions, we can also say that contractive mappings are also: 

1. Strictly nonexpansive
    2. which implies that they can have at most one one fixed point
2. Hölder-continuous
    2. more precisely: Lipschitz-continuous


Contractive mappings are special in the sense that we can use the **contraction-mapping theorem** to establish the \underline{existence} of a unique fixed-point. Furthermore, the proof of this theorem is constructive
and gives us a procedure to find this fixed point.


# Contraction-mapping theorem 

Theorem (Contraction-mapping theorem, Banach 1922).

: Given a contractive mapping $T: D \subset \mathbb{R}^n \to \mathbb{R}^n$ on the closed set $D_0 \subset D$ and for which $TD_0 \subset D_0$, then $T$ has a unique fixed point in $D_0$. 

Proof

: Consider the sequence of iterates generated by: 
    \begin{align*}
    x^{(k)} = T x^{(k-1)}, \enspace k=1,2,..., \enspace \text{given } x_0 \in D_0 \enspace .
    \end{align*}
    By assumption $TD_0 \subset D_0$, which implies that all $\{x^{(k)}\}$ remain in $D_0$. Using the contraction property: 
    \begin{align*}
    \|x^{(k+1)} - x^{(k)} \| = \| Tx^{k} - Tx^{k-1}\| \leq \gamma \| x^{(k)} - x^{(k-1)}\| \enspace .
    \end{align*}

# Proof (continued)

Proof (continuation of the contraction-mapping proof)

:  Writing the difference between the $k+p$-th iterate and the $k$-th one as a telescoping series: 
    \begin{align*}
       \| x^{(k+p)} - x^{(k})\|= \| \sum_{i=1}^p x^{(k+i)} - x^{(k+i-1)}\| \enspace .
    \end{align*}
    Using the subadditivity/triangle inequality: 
    \begin{align*}
    \| x^{(k+p)} - x^{(k})\| &\leq \sum_{i=1}^p \|x^{(k+i)} - x^{(k+i-1)}\| \\
    &= \sum_{i=1}^p \|T^{k+i} x^{(0)} - T^{k+i-1}x^{(0)}\| \\
    &\leq \sum_{i=1}^p \gamma^{k+i-1} \|x^{(1)} - x^{(0)}\| \enspace .
    \end{align*}

# Proof (continued)

Lemma (Sum of the first $n+1$ terms of a geometric series)

: Let $\gamma \in \mathbb{R}, \gamma \not = 1$, and $\alpha \in \mathbb{R}$:
\begin{align*}
\sum_{i=0}^n \alpha \gamma^k = \alpha \frac{1 - \gamma^{n+1}}{1 - \gamma} \enspace .
\end{align*}

Continuing the above proof: 

  \begin{align*}
    \| x^{(k+p)} - x^{(k)})\| &\leq \sum_{i=1}^p \gamma^{k+i-1} \|x^{(1)} - x^{(0)}\| &= \gamma^k\frac{\left(1-\gamma^{(p+1)}\right)}{(1 - \gamma)}\|x^{(1)} - x^{(0)}\| \\
    &\leq \frac{\gamma^k}{(1 - \gamma)}\|x^{(1)} - x^{(0)}\| \enspace .
    \end{align*}

# Proof (continued)

Definition (Cauchy sequence)

: A sequence $\{x^{(k)}\}$, is called a **Cauchy sequence**  if given any $\epsilon > 0$, there exists a positive integer $N(\epsilon)$ such that for all $m,n > N(\epsilon)$, $\|x^{(m)} - x^{(n)}\| < \epsilon$.

Practically speaking, this means that we can make $\|x^{(k+p)} - x^{(k)}\|$ arbitrarily small for a sufficiently large $p$. 
  \begin{align*}
   \| x^{(k+p)} - x^{(k)})\| &\leq \frac{\gamma^k}{(1 - \gamma)}\|x^{(1)} - x^{(0)}\| \enspace .
\end{align*}

Using the fact that $\|x^{(k+p)} - x^{(k)}\|$ is a Cauchy sequence, we conclude that $\{x^{(k)}\}$ has a limit $x^\star$ in $D_0$ and that $\lim_{k\to \infty} Tx^{(k)} = Tx^\star$ and $x^\star$ is a fixed point of $T$.

# 

Linear algebra

# Norm

Definition (Norm)

: A **norm** $\|\cdot \|$ is a mapping from $\mathbb{R}^n$ (or $\mathbb{C}^n$) to $\mathbb{R}$ with the following properties: 

    1. $\|x\| \geq 0, \forall x \in \mathbb{R}^n$ and $\|x \| = 0$ only if $x = 0$
    2. $\|\alpha x \| = |\alpha |\|x \|,  \enspace \forall x \in \mathbb{R}^n, \alpha \in \mathbb{R}$
    3. $\| x + y \| \leq \|x \| + \|y \|, \enspace \forall x,y \in \mathbb{R}^n$


# Linear maps

Definition (Linear map). \label{def:linmap}

:    A linear map $T$ is a function $T: \mathcal{V} \to \mathcal{W}$ over a pair of vector spaces $\mathcal{V}$ and $\mathcal{W}$ satisfying two properties:

     - Additivity: $T(u + v) = T(u) + T(v), \forall u,v \in \mathcal{V}$
     - Homogeneity: $T(\alpha v) = \alpha T(v), \forall \alpha \in \mathcal{V}, \alpha \in \mathbb{F}$ where $\mathcal{F}$ is a field (like $\mathbb{R}$)


Examples:

- The identity map $I: \mathcal{V} \to \mathcal{V}: v \mapsto v$
- A definite integral can be seen as a linear map from the space of real-valued functions to the reals, that is: $T:(\mathbb{R}^n \to \mathbb{R}) \to \mathbb{R} : f \mapsto \int_a^b f(x) dx$ 
- The derivative (more on that below)

# Vector space of linear maps

Definition (Vector space of linear maps)

:    The set of all linear maps from a pair of vector spaces $\mathcal{V}$ and $\mathcal{W}$ is itself a vector space where the operations of addition and scalar multiplication are defined as:

      - Addition: $(T + S)(v) = T(v) + S(v)$ 
      - Scalar multiplication: $(\alpha T)(v) = \alpha (T(v)), \forall \alpha \in \mathcal{F}, v \in \mathcal{V}$

Furthermore, if $T: \mathcal{V} \to \mathcal{W}$ and $S: \mathcal{U} \to \mathcal{V}$, then the **product** or **composition** of $T$ with $S$ is the linear map $TS:\mathcal{U} \to \mathcal{W}$ defined as $(TS)(u) = T(S(u)) = (T \circ S)(u), u \in \mathcal{U}$.

# Matrix of a linear map

An important property of linear maps is that they can be uniquely identified given their values on a basis. Let $T: \mathcal{V} \to \mathcal{W}$:

-  If $\{v_1, \hdots, v_n\}$ is a basis of $\mathcal{V}$, we can represent any $v \in \mathcal{V}$ by a unique set of coefficients $\{c_1, ..., c_ n\}$ called *coordinates* such that $v = \sum_{j=1}^n c_j v_j$
-  If we have a linear map $T: \mathcal{V} \to \mathcal{W}$, then $T(v) = \sum_{j=1}^n c_j T(v_j)$.
-  Since $T(v_j) \in \mathcal{W}$, then $T(v_j) = \sum_{j=1}^m a_{i,j} w_j$ where $\{w_1, \hdots, w_m\}$ is a basis of $\mathcal{W}$
- Therefore:  $T(v) = \sum_{j=1}^n c_j T(v_j) = \sum_{j=1}^n c_j \sum_{i=1}^m a_{i,j} w_i$. 
- The $a$'s are the entries of the matrix $A$ whose columns are the $T(v_j)$ in the basis of $\mathcal{W}$.

# Neumann Lemma

Let $A \in L(\mathbb{R}^n, \mathbb{R}^n)$, if $\sigma(A) < 1$, then $(I - A)^{-1}$ exists and: 

\begin{align*}
(I - A)^{-1} = \lim_{k\to \infty} \sum_{i=0}^k A^i \enspace .
\end{align*}

(To continue next class)